<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Example Project</title>
		<script src="engine/misc/JumpStart.js"></script>

		<script>
			var g_extraBlock = null;

			function spin()
			{
				this.rotateY(1.0 * g_deltaTime);
			}

			function extraSpawn()
			{
				g_extraBlock = this;
			}

			function extraRemove()
			{
				console.log("Object removed listener.");
			}

			jumpStart.setOptions({"debug": {"showCursorPlanes": true}});
			jumpStart.addEventListener("precache", function()
			{
				// Async
				jumpStart.loadModels(["models/block"]).then( function()
				{
					jumpStart.doneCaching();
				});

				// true	: SYNCHRONOUS
				// false: ASYNCHRONOUS (must call JumpStart.doneCaching)
				return false;
			});

			jumpStart.addEventListener("initialize", function()
			{
				// This listener only gets called when initializing the room of a multiuser app.
				var extraBlock = jumpStart.spawnInstance("models/block");
				extraBlock.translateY(200);
				extraBlock.addEventListener("tick", spin);
				extraBlock.addEventListener("spawn", extraSpawn);
				extraBlock.addEventListener("remove", extraRemove);
				extraBlock.syncData.myVar = "5150";
				extraBlock.sync();

				// true	: SYNCHRONOUS
				// false: ASYNCHRONOUS (must call JumpStart.doneInitializing)
				return true;
			});

			jumpStart.addEventListener("ready", function()
			{
				var southBoundary = jumpStart.spawnCursorPlane({"parent": jumpStart.scene});
				southBoundary.blocksLOS = true;
				southBoundary.rotateX(Math.PI / 2.0);

				southBoundary.addEventListener("cursordown", function()
				{
					g_extraBlock.position.copy(jumpStart.localUser.cursorHit.scaledPoint);
					g_extraBlock.sync();
				});

				var cursor = jumpStart.spawnInstance("models/block");
				cursor.addEventListener("tick", function()
				{
					if( !jumpStart.localUser.cursorHit )
						return;

					var pos = jumpStart.localUser.cursorHit.scaledPoint.clone();
					pos.y += 100.0;

					this.position.copy(pos);
				});
				cursor.translateY(100);

				var myObject = jumpStart.spawnInstance("models/block");
				myObject.blocksLOS = true;

				myObject.addEventListener("tick", function()
				{
					this.rotateY(2.0 * g_deltaTime);
				});

				myObject.addEventListener("cursorenter", function()
				{
					console.log("Object is being highlighted (and then scaled)! " + this);
					this.scale.set(2, 2, 2);
				});

				myObject.addEventListener("cursorexit", function()
				{
					console.log("Object is being un-highlighted (then scaled)! " + this);
					this.scale.set(1, 1, 1);
				});

				myObject.addEventListener("cursordown", function()
				{
					console.log("Object is being clicked down (then shifted on x-axis)! " + this);
					myObject.translateX(20.0);

					jumpStart.world.translateX(100.0);
				});

				myObject.addEventListener("cursorup", function()
				{
					console.log("Object is being clicked up (then removed)! " + this);
					//jumpStart.removeInstance(this);
					jumpStart.removeInstance(g_extraBlock);
				});

				myObject.addEventListener("spawn", function()
				{
					console.log("Object is being spawned! " + this);
				});

				myObject.addEventListener("remove", function()
				{
					console.log("Object is being removed! " + this);
				});

				// true	: SYNCHRONOUS
				// false: ASYNCHRONOUS (must call JumpStart.run)
				return true;
			});
		</script>
	</head>

	<body>
	</body>
</html>