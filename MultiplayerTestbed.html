<style>
	div { width: 33.3%; height: 50%; display: inline-flex; flex-direction: column; }
	#container { width: 100%; height: 100%; display: block;  }
	iframe { flex: 1; }
	.addressBar { display: flex; }
	.address { flex: 1; }
</style>
<form id="init">
	<input id="num" />
	<input id="delay" />
	<input id="url" />
	<input type="submit" value="Go" />
	<div id="container"></div>
</form>
<script>
	console.log('sup');
	const $ = (s, e) => { e = e || document; return e.querySelector(s) };
	const $$ = (s, e) => { e = e || document; return e.querySelectorAll(s) };
	const container = $('#container');

	class TestFrame {
		constructor (index, delay, url) {
			const div = document.createElement('div');
			const separator = url.match(/\?/) ? '&' : '?';
			const frameUrl = `${url}${separator}i=${index}`;
			div.innerHTML = `
				<iframe src="${frameUrl}"></iframe>
				<form class="addressBar"><input class="address" /><input type="submit" value="Go" /></form>
			`;
			$('form', div).addEventListener('submit', function (event) {
				$('iframe', div).src = $('input', div).value;
				event.preventDefault();
			});
			$('iframe', div).addEventListener('load', function () {
				console.log(index, 'loaded');
				$('input', div).value = this.contentDocument.location.href;
			});
			setTimeout(function () {
				container.appendChild(div);
			}, delay * index)
		}
	}

	$('#init').addEventListener('submit', function (event) {
		container.innerHTML = '';
		for (let i = 0; i < parseInt($('#num').value, 10); i++) {
			new TestFrame(i, parseInt($('#delay').value, 10), $('#url').value);
		}
		event.preventDefault();
	});
</script>
